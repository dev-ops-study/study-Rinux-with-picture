# 사용자 모드 (User Mode)

사용자 모드는 응용 프로그램이 실행되는 기본 환경입니다. 시스템 자원에 대한 직접적인 접근을 제한하여 한 프로그램의 오류가 전체 시스템을 무너뜨리지 않도록 보호합니다.

### 1. 사용자 모드 vs 커널 모드

운영체제는 CPU의 실행 권한을 두 가지 모드로 분리하여 관리합니다.

| 구분     | 사용자 모드 (User Mode)   | 커널 모드 (Kernel Mode)         |
| -------- | ------------------------- | ------------------------------- |
| **권한** | 제한적 권한 (비특권 모드) | 모든 자원 접근 가능 (특권 모드) |
| **목적** | 일반 응용 프로그램 실행   | OS 핵심 서비스 및 하드웨어 제어 |
| **보안** | 하드웨어 직접 접근 불가   | 메모리, CPU, 디스크 직접 제어   |

### 2. 시스템 콜 (System Call)

사용자 모드 프로그램이 하드웨어 자원이나 커널의 기능(파일 읽기, 네트워크 전송 등)이 필요할 때 **운영체제에 요청하는 유일한 통로**입니다. 일종의 '보안 창구' 역할을 합니다.

### 3. CPU 모드 변경 (Mode Transition)

CPU 내부에 있는 **Mode Bit**를 통해 모드가 전환됩니다.

- **사용자 → 커널:** 시스템 콜 발생 시 Mode Bit가 **0**으로 바뀌며 커널 모드로 진입합니다.
- **커널 → 사용자:** 작업 완료 후 Mode Bit가 **1**로 바뀌며 다시 사용자 모드로 복귀합니다.

### 4. 메모장 예시

우리가 메모장(Notepad)을 사용할 때의 과정은 다음과 같습니다.

1. **사용자 모드:** 사용자가 글자를 입력하고 편집합니다.
2. **시스템 콜 호출:** 사용자가 '저장' 버튼을 누르면 메모장은 `Write()` 시스템 콜을 호출합니다.
3. **커널 모드 전환:** CPU가 커널 모드로 바뀌며 OS가 디스크(SSD/HDD)에 데이터를 기록합니다.
4. **사용자 모드 복귀:** 저장이 끝나면 다시 메모장 화면으로 돌아옵니다.

### 5. 확인 명령어

현재 시스템의 모드 전환이나 시스템 콜 발생 현황을 관찰할 수 있는 도구입니다.

- **Linux/Unix:** `strace` (프로그램이 실행되는 동안 발생하는 모든 시스템 콜 추적)
- 예: `strace ls`

상세 옵션 예시: `strace -T -o output.txt -tt ls`

-T: 각 시스템 콜에 소요된 시간 표시

-o: 결과를 파일로 저장

-tt: 마이크로초 단위의 상세 시간 표시

- **Linux/Unix:** `sar` (프로세스 CPU 모드 비율)
- 예: `sar -P ALL 1 1`
  한 줄의 합은 100%
- usr+nice = 사용자
- system = 커널
